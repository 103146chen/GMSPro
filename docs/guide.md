# 📖 GMSPro 使用手冊 (User Guide)

歡迎使用 GMSPro！本手冊將引導您熟悉系統的兩大核心模組：**GradeFlow** 與 **Notifier**。

---

## 🟢 GradeFlow：成績管理系統

GradeFlow 是親師生查看成績的入口。系統分為「管理端 (教師)」與「客戶端 (學生/家長)」。

### 1. 教師端儀表板 (Dashboard)

#### 雙軌模式 (Dual Mode)
系統支援兩種身分切換，請依據您的需求選擇：

* **📘 任課模式 (Subject Mode - Blue)**
    * **適用對象**：科任教師。
    * **功能**：專注於單一科目的成績登錄與分析。
    * **特點**：介面為藍色系，僅顯示您任教的班級。

* **🔮 導師模式 (Homeroom Mode - Purple)**
    * **適用對象**：班級導師。
    * **功能**：整合全班所有科目的成績、缺勤與排名。
    * **特點**：介面為粉紫色系，可查看學生的總成績與五標落點。

#### 數據分析圖表
在儀表板中，您可以看到以下數據：
* **前三名排行 (Top 3)**：系統自動計算總分最高的學生 (需在資料庫設定權重)。
* **五標分布圖**：直方圖顯示全班成績在 頂/前/均/後/底 標的人數分布。

### 2. 學生/家長查詢端 (Client Portal)

這是您發布給家長的 Web App 網址介面。

#### 登入機制
* **網址**：部署後產生的 `Web App URL`。
* **帳號**：學生座號 (例如 `1` 或 `01`)。
* **密碼**：
    * **學生預設**：`student` + `{{座號補零}}` (例：座號 5 號為 `student05`)。
    * **家長預設**：`parent` + `{{座號補零}}` (例：座號 5 號為 `parent05`)。
    * *註：首次登入後建議修改密碼。*

#### 自動登入 (Auto-login)
v10.3 版本後，系統會自動記住瀏覽器中的登入狀態。若是在公用電腦使用，請務必點擊右上角的 **「登出」**。

---

## 🔵 Notifier：缺勤通知機器人

Notifier 負責自動化建立班級表格，並掃描缺交作業寄送 Email。

### 1. 使用建立器 (The Creator) <span id="using-creator"></span>

這是最快建立新班級的方法，不需要手動開 Google Sheets。

1.  點擊選單中的 **「建立班級 (Creator)」**。
2.  **輸入班級名稱**：例如 `701_國文`。
3.  **貼上名單**：從 Excel 複製「座號、姓名、Email」三欄資料，直接貼上到文字框中。
4.  **設定權限**：
    * 勾選「建立公開連結」：會自動開啟試算表的共用權限。
    * 設定「小老師 Email」：小老師也會收到缺交報表。
5.  點擊 **「開始建立」**。系統會自動生成 Google Sheet 並註冊到後台。

### 2. 試算表格式規範 (Sheet Rules)

為了讓機器人讀懂您的成績單，請遵守以下格式：

* **第一列 (Row 1)**：必須是 **日期** (格式：`YYYY/MM/DD`)。
    * *機器人會略過「未來日期」的欄位。*
* **第二列 (Row 2)**：**作業名稱** (例如：`L1習作`, `第一次段考`)。
* **第三列 (Row 3)**：權重/滿分 (選填)。
* **第四列起**：學生名單與成績。
    * **缺交標記**：請填入 `缺`、`x` 或留空 (視設定而定，預設掃描 `缺` 字)。

### 3. 設定排程 (Triggers) <span id="setting-triggers"></span>

讓機器人自動跑起來！

1.  進入 **「設定 (Settings)」** 頁面。
2.  找到 **「排程設定」** 區塊。
3.  **每日掃描**：建議設定在放學後 (例如 `17:00`)。
4.  **週報通知**：建議設定在週末 (例如 `週五 20:00`)。
5.  點擊 **「儲存設定」**。

> **💡 小技巧**：您隨時可以點擊儀表板上的 **「立即掃描」** 按鈕來手動觸發一次檢查。

---

## ⚙️ 進階管理

### 資料庫維護
* **DB_Source**：這是系統的「快取」資料庫，每天會自動從各班的 Google Sheets 抓取最新成績覆寫。**請勿手動修改此頁面，因為會被覆蓋。**
* **DB_Auth**：這是權限中心，儲存了密碼雜湊與 Email。若學生忘記密碼，老師可在此頁面手動清除該生密碼欄位，即可恢復預設值。

### 常見問題 (FAQ)

**Q: 為什麼家長收不到通知信？**
1.  請檢查 Google Sheet 中該生的 Email 欄位是否正確。
2.  檢查 Gmail 的「寄件備份」，確認系統是否有嘗試發送。
3.  若是使用免費 Gmail 帳號，每日發信上限為 **100 封**；Google Workspace 教育帳號為 **1500 封**。

**Q: 新增的作業為什麼沒出現在成績單？**
A: 請確認該欄位的 **第一列日期** 是否填寫正確。系統會自動過濾掉沒有日期的欄位，防止誤讀雜訊。