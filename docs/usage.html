<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>操作手冊 & Live Demo | GMSPro Guide</title>
    <meta property="og:type" content="website">
    <meta property="og:title" content="GMSPro | 為教育而生的自動化系統">
    <meta property="og:description" content="別再當成績輸入機器。讓 Notifier 處理行政，讓 GradeFlow 呈現數據。免費、開源、私有的教育解決方案。">
    <meta property="og:image" content="https://您的GitHub帳號.github.io/GMSPro/docs/Usage/images/Main_01.png"> <meta property="og:url" content="https://您的GitHub帳號.github.io/GMSPro/">
    <meta name="twitter:card" content="summary_large_image">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'Noto Sans TC', 'sans-serif'] },
                    colors: {
                        brand: { blue: '#2563EB', purple: '#9333EA', dark: '#020617' } // Slate-950
                    }
                }
            }
        }
    </script>
    <style>
        /* 核心佈局 */
        body { overflow: hidden; background-color: #020617; color: white; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* 左側選單樣式 (Dark Mode) */
        .nav-header { cursor: pointer; transition: all 0.2s; border-left: 3px solid transparent; }
        .nav-header:hover { background-color: rgba(255,255,255,0.05); }
        .nav-header.active { background-color: rgba(37, 99, 235, 0.1); border-left-color: #3b82f6; color: #60a5fa; }
        
        /* 子選單動畫 */
        .nav-sub-list { max-height: 0; overflow: hidden; opacity: 0; transition: all 0.3s ease-in-out; background-color: rgba(0,0,0,0.2); }
        .nav-sub-list.open { max-height: 1000px; opacity: 1; }

        .sub-item { padding-left: 3.5rem; cursor: pointer; position: relative; transition: all 0.2s; color: #94a3b8; font-size: 0.85rem; padding-top: 0.6rem; padding-bottom: 0.6rem; border-left: 1px solid rgba(255,255,255,0.05); }
        .sub-item:hover { color: white; background-color: rgba(255,255,255,0.05); }
        .sub-item.active { color: #60a5fa; font-weight: 700; background-color: rgba(37, 99, 235, 0.1); border-left: 3px solid #3b82f6; }

        /* Demo 按鈕樣式 (Glowing Cards) */
        .demo-btn { display: flex; align-items: center; width: 100%; padding: 0.75rem 1rem; font-size: 0.875rem; font-weight: 600; border-radius: 0.75rem; transition: all 0.3s; border: 1px solid rgba(255,255,255,0.1); color: #cbd5e1; background-color: rgba(30, 41, 59, 0.5); position: relative; overflow: hidden; }
        .demo-btn:hover { border-color: rgba(255,255,255,0.3); color: white; background-color: rgba(30, 41, 59, 0.8); transform: translateY(-1px); }
        .demo-btn.active { background: linear-gradient(135deg, rgba(37, 99, 235, 0.2), rgba(147, 51, 234, 0.2)); border-color: #60a5fa; color: white; box-shadow: 0 0 15px rgba(37, 99, 235, 0.3); }
        .demo-btn.active::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; background: #60a5fa; }

        /* 瀏覽器視窗框 (與 tutorial.html 一致) */
        .browser-window { background: #1e293b; border-radius: 0.75rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border: 1px solid rgba(255, 255, 255, 0.1); overflow: hidden; display: flex; flex-direction: column; width: 100%; height: 100%; position: relative; }
        /* 全寬工具列 */
        .browser-toolbar { height: 3rem; background: #0f172a; display: flex; align-items: center; padding-left: 1rem; gap: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.05); flex: none; }
        .dot { width: 0.6rem; height: 0.6rem; border-radius: 9999px; }
        .address-bar { flex: 1; height: 2rem; margin-left: 1rem; margin-right: 1rem; max-width: 600px; background: rgba(0,0,0,0.3); border-radius: 0.3rem; border: 1px solid rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; font-family: monospace; font-size: 0.8rem; color: #94a3b8; }

        /* 圖片導航按鈕 */
        .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); width: 3rem; height: 3rem; background: rgba(0,0,0,0.6); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; z-index: 20; opacity: 0; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(4px); }
        .img-content-area:hover .nav-btn { opacity: 1; }
        .nav-btn:hover { background: rgba(37, 99, 235, 0.8); transform: translateY(-50%) scale(1.1); }
        .nav-btn.prev { left: 20px; }
        .nav-btn.next { right: 20px; }
    </style>
</head>
<body class="bg-slate-950 text-white antialiased h-screen flex flex-col">

    <nav class="fixed top-0 w-full z-50 text-white/90 transition-all duration-300 bg-slate-950/80 backdrop-blur-md border-b border-white/5 h-16 flex-none">
        <div class="w-full px-6 h-full flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-2 group hover:text-white transition">
                <div class="bg-blue-600 text-white w-8 h-8 rounded flex items-center justify-center font-bold text-lg shadow-lg shadow-blue-500/30">G</div>
                <span class="font-bold text-lg tracking-tight">GMSPro</span>
            </a>
            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-slate-400">
                <a href="index.html" class="hover:text-blue-400 transition">首頁</a>
                <a href="features.html" class="hover:text-blue-400 transition">功能解析</a>
                <a href="usage.html" class="text-white font-bold border-b border-blue-500 pb-0.5">操作手冊</a>
                <a href="tutorial.html" class="hover:text-blue-400 transition">部署教學</a>
                <a href="https://github.com/103146chen/GMSPro" target="_blank" class="hover:text-white transition"><i class="fa-brands fa-github text-lg"></i></a>
            </div>
        </div>
    </nav>

    <div class="flex-1 flex overflow-hidden w-full pt-16">
        <aside class="w-80 bg-slate-900/50 backdrop-blur border-r border-white/5 flex flex-col z-10 shadow-2xl flex-none hidden md:flex">
            <div class="p-5 border-b border-white/5 bg-gradient-to-b from-slate-800/30 to-transparent">
                <h2 class="text-xs font-bold text-blue-400 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                    Live Simulation
                </h2>
                <div class="space-y-3">
                    <button onclick="activateDemo('demo-Notifier.html', this)" class="demo-btn group">
                        <span class="w-8 h-8 rounded-lg bg-indigo-500/20 text-indigo-400 flex items-center justify-center mr-3 text-sm group-hover:bg-indigo-500 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-chalkboard-user"></i>
                        </span>
                        <div>
                            <div class="text-sm font-bold">教師管理系統</div>
                            <div class="text-[10px] text-slate-500 font-normal">System Admin Panel</div>
                        </div>
                    </button>
                    <button onclick="activateDemo('demo-GradeFlow.html', this)" class="demo-btn group">
                        <span class="w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center mr-3 text-sm group-hover:bg-blue-500 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-graduation-cap"></i>
                        </span>
                        <div>
                            <div class="text-sm font-bold">學生查詢系統</div>
                            <div class="text-[10px] text-slate-500 font-normal">GradeFlow Portal</div>
                        </div>
                    </button>
                </div>
            </div>
            <div class="p-4 border-b border-white/5 bg-slate-900/30">
                <h2 class="text-xs font-bold text-slate-500 uppercase tracking-widest">Guide Book</h2>
            </div>
            <div id="sidebar-tree" class="flex-1 overflow-y-auto no-scrollbar py-2"></div>
        </aside>

        <main class="flex-1 bg-slate-950 h-full relative overflow-hidden flex flex-col">
            <div class="browser-toolbar w-full flex-none z-20">
                <div class="flex gap-1.5 ml-2">
                    <div class="dot bg-red-500/80"></div><div class="dot bg-yellow-500/80"></div><div class="dot bg-green-500/80"></div>
                </div>
                <div class="address-bar mx-auto" id="browser-url">
                    <i class="fa-solid fa-lock text-[10px] mr-2 text-green-500"></i> docs/Usage/Guide/01_startup.png
                </div>
                <div class="flex gap-2 mr-4">
                    <button onclick="reloadFrame()" class="text-slate-500 hover:text-white px-2 py-1 rounded hover:bg-white/10 transition" title="Refresh"><i class="fa-solid fa-rotate-right"></i></button>
                </div>
            </div>

            <div class="flex-1 bg-slate-900 relative overflow-hidden img-content-area group w-full h-full">
                <div id="img-container" class="w-full h-full flex items-center justify-center p-0 md:p-4 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-slate-900">
                    <img id="active-image" src="" class="max-w-full max-h-full object-contain shadow-2xl rounded-sm transition-opacity duration-200" alt="Guide Step">
                </div>
                <iframe id="active-demo" class="hidden w-full h-full bg-white border-none" src=""></iframe>
                <button id="btn-prev" class="nav-btn prev" onclick="prevSlide()"><i class="fa-solid fa-chevron-left"></i></button>
                <button id="btn-next" class="nav-btn next" onclick="nextSlide()"><i class="fa-solid fa-chevron-right"></i></button>
            </div>

            <div id="page-indicator" class="absolute bottom-6 left-1/2 -translate-x-1/2 bg-slate-800/90 border border-white/10 text-white px-4 py-2 rounded-full text-xs backdrop-blur-md md:hidden z-30">
                <span id="mobile-indicator">1 / 20</span>
            </div>
        </main>
    </div>

    <script>
        const IMG_BASE_PATH = "Usage/images/";
        const treeData = [
            { title: "01 系統啟動", icon: "fa-solid fa-power-off", steps: [ { title: "啟動畫面", src: "01_startup.png" } ] },
            { title: "02 系統設定", icon: "fa-solid fa-gears", steps: [ { title: "設定主頁面", src: "02-0_systemSettings.png" }, { title: "金鑰與封存設定", src: "02-1_salting,archieving,testing.png" } ] },
            { title: "03 檔案建立中心", icon: "fa-solid fa-wand-magic-sparkles", steps: [ { title: "功能選單", src: "03-0_fileMaker.png" }, { title: "建立成績單 (批次/單一)", src: "03-1_singleFile.png" }, { title: "建立 GradeFlow 資料庫", src: "03-3_DBMaker.png" } ] },
            { title: "04 連結管理中心", icon: "fa-solid fa-link", steps: [ { title: "介面介紹", src: "04-0_linkerIntro.png" }, { title: "設定單一連結", src: "04-1_linkSingleFile.png" }, { title: "連結完成狀態", src: "04-2_afterSettingLink.png" } ] },
            { title: "05 任課老師操作", icon: "fa-solid fa-chalkboard-user", steps: [ { title: "任課儀錶板", src: "05-0_teacherIntro.png" }, { title: "缺交掃描入口", src: "05-1_sendNoticeMail(1)-enterance.png" }, { title: "缺交發信視窗", src: "05-2_sendNotiveMail(2)-modal.png" }, { title: "成績通知入口", src: "05-3_sendScoreMail(1)-enterance.png" }, { title: "成績發信視窗", src: "05-4_sendScoreMail(2)-modal.png" } ] },
            { title: "06 導師操作", icon: "fa-solid fa-user-tie", steps: [ { title: "導師儀錶板", src: "06-0_homeroomTeacherIntro.png" }, { title: "全班成績總覽", src: "06-1_homeroomTeacherSurface.png" }, { title: "設定 DB 連結入口", src: "06-2_setDBURLenterance.png" }, { title: "填寫 DB 網址", src: "06-3_setupDBURL.png" }, { title: "執行同步 (Sync)", src: "06-4_setSYNCcontent.png" } ] },
            { title: "07 學生端 (GradeFlow)", icon: "fa-solid fa-graduation-cap", steps: [ { title: "系統初始化", src: "07-0_GRADEFLOW_setup.png" }, { title: "學生登入", src: "07-1_GRADEFLOW_login.png" }, { title: "功能介紹 (列表)", src: "07-2_GRADEFLOW_functions(1).png" }, { title: "功能介紹 (圖表)", src: "07-2_GRADEFLOW_functions(2).png" } ] },
            { title: "08 疑難排解 (FAQ)", icon: "fa-solid fa-circle-question", steps: [ { title: "權限核准失敗", src: "faq_auth_error.png" }, /* 您可能需要製作這張圖，或用文字說明*/ { title: "Email 額度限制", src: "faq_quota.png" }, { title: "腳本執行逾時", src: "faq_timeout.png" } ] }
        ];

        let state = { catIndex: 0, stepIndex: 0 };
        let isDemoMode = false;

        function init() {
            renderSidebar();
            updateUI();
            document.addEventListener('keydown', (e) => {
                if (isDemoMode) return;
                if(e.key === 'ArrowRight') nextSlide();
                if(e.key === 'ArrowLeft') prevSlide();
            });
        }

        function activateDemo(demoFile, btn) {
            isDemoMode = true;
            document.getElementById('img-container').classList.add('hidden');
            const iframe = document.getElementById('active-demo');
            iframe.classList.remove('hidden');
            document.getElementById('btn-prev').classList.add('hidden');
            document.getElementById('btn-next').classList.add('hidden');
            document.getElementById('page-indicator').classList.add('hidden');
            const fakeUrl = demoFile.includes('Notifier') ? 'script.google.com/macros/s/exec' : 'gradeflow.app/student/login';
            document.getElementById('browser-url').innerHTML = `<i class="fa-solid fa-lock text-[10px] mr-2 text-green-500"></i> https://${fakeUrl}`;
            if (iframe.src.indexOf(demoFile) === -1) iframe.src = demoFile;
            document.querySelectorAll('.demo-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            document.querySelectorAll('.nav-header').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-sub-list').forEach(el => el.classList.remove('open'));
            document.querySelectorAll('.sub-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.fa-chevron-down').forEach(el => el.style.transform = 'rotate(0deg)');
        }

        function jumpTo(c, s) {
            isDemoMode = false;
            state.catIndex = c;
            state.stepIndex = s;
            document.getElementById('img-container').classList.remove('hidden');
            document.getElementById('active-demo').classList.add('hidden');
            document.getElementById('btn-prev').classList.remove('hidden');
            document.getElementById('btn-next').classList.remove('hidden');
            document.getElementById('page-indicator').classList.remove('hidden');
            document.querySelectorAll('.demo-btn').forEach(b => b.classList.remove('active'));
            updateUI();
        }

        function reloadFrame() {
            if(isDemoMode) { document.getElementById('active-demo').contentWindow.location.reload(); } 
            else { const img = document.getElementById('active-image'); const src = img.src; img.src = ''; setTimeout(() => img.src = src, 100); }
        }

        function renderSidebar() {
            const container = document.getElementById('sidebar-tree');
            container.innerHTML = '';
            treeData.forEach((cat, cIdx) => {
                const groupDiv = document.createElement('div');
                const headerBtn = document.createElement('div');
                headerBtn.id = `header-${cIdx}`;
                headerBtn.className = `nav-header w-full px-4 py-3 flex items-center justify-between group border-b border-white/5`;
                headerBtn.innerHTML = `<div class="flex items-center gap-3"><span class="w-6 text-center text-slate-500 group-hover:text-blue-400 transition-colors"><i class="${cat.icon}"></i></span><span class="font-bold text-sm text-slate-300 group-hover:text-white transition-colors">${cat.title}</span></div><i class="fa-solid fa-chevron-down text-xs text-slate-600 transition-transform duration-200" id="arrow-${cIdx}"></i>`;
                headerBtn.onclick = () => jumpTo(cIdx, 0);
                groupDiv.appendChild(headerBtn);
                const subList = document.createElement('div');
                subList.id = `sublist-${cIdx}`;
                subList.className = `nav-sub-list`;
                cat.steps.forEach((step, sIdx) => {
                    const subItem = document.createElement('div');
                    subItem.id = `item-${cIdx}-${sIdx}`;
                    subItem.className = `sub-item truncate`;
                    subItem.innerText = step.title;
                    subItem.onclick = (e) => { e.stopPropagation(); jumpTo(cIdx, sIdx); };
                    subList.appendChild(subItem);
                });
                groupDiv.appendChild(subList);
                container.appendChild(groupDiv);
            });
        }

        function nextSlide() {
            if(isDemoMode) return;
            const cat = treeData[state.catIndex];
            if (state.stepIndex < cat.steps.length - 1) { state.stepIndex++; } else if (state.catIndex < treeData.length - 1) { state.catIndex++; state.stepIndex = 0; } else { return; }
            updateUI();
        }

        function prevSlide() {
            if(isDemoMode) return;
            if (state.stepIndex > 0) { state.stepIndex--; } else if (state.catIndex > 0) { state.catIndex--; state.stepIndex = treeData[state.catIndex].steps.length - 1; }
            updateUI();
        }

        function updateUI() {
            const cat = treeData[state.catIndex];
            const step = cat.steps[state.stepIndex];
            document.getElementById('browser-url').innerHTML = `<i class="fa-solid fa-image text-[10px] mr-2 text-blue-500"></i> docs/Usage/images/${step.src}`;
            treeData.forEach((_, idx) => {
                const header = document.getElementById(`header-${idx}`);
                const sublist = document.getElementById(`sublist-${idx}`);
                const arrow = document.getElementById(`arrow-${idx}`);
                if (idx === state.catIndex) { header.classList.add('active'); sublist.classList.add('open'); arrow.style.transform = 'rotate(180deg)'; } 
                else { header.classList.remove('active'); sublist.classList.remove('open'); arrow.style.transform = 'rotate(0deg)'; }
            });
            document.querySelectorAll('.sub-item').forEach(el => el.classList.remove('active'));
            const activeItem = document.getElementById(`item-${state.catIndex}-${state.stepIndex}`);
            if (activeItem) { activeItem.classList.add('active'); activeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }
            const imgEl = document.getElementById('active-image');
            imgEl.style.opacity = 0;
            setTimeout(() => { imgEl.src = IMG_BASE_PATH + step.src; imgEl.style.opacity = 1; }, 150);
            const totalImages = treeData.reduce((acc, curr) => acc + curr.steps.length, 0);
            let currentFlatIndex = 1;
            for(let i=0; i<state.catIndex; i++) currentFlatIndex += treeData[i].steps.length;
            currentFlatIndex += state.stepIndex;
            const mobileIndicator = document.getElementById('mobile-indicator');
            if(mobileIndicator) mobileIndicator.innerText = `${currentFlatIndex} / ${totalImages}`;
        }

        init();
    </script>
</body>
</html>